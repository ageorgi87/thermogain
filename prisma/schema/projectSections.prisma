// Project Sections - Detailed wizard steps data
// Each project has 7 sections that store specific information collected during the wizard
// All sections have a one-to-one relationship with Project and cascade delete

// Section 1: Logement (Housing Information)
model ProjectLogement {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  code_postal        String
  annee_construction Int
  surface_habitable  Float
  nombre_occupants   Int
  qualite_isolation  String @default("Moyenne") // "Mauvaise", "Moyenne", "Bonne"

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 2: Chauffage Actuel (Current Heating System) + Consumption
model ProjectChauffageActuel {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  type_chauffage    String
  age_installation  Int
  etat_installation String

  // Does user know their consumption? (determines which fields to collect)
  connait_consommation Boolean @default(true)

  // Consumption data - conditional based on type_chauffage and connait_consommation
  conso_fioul_litres Float?
  prix_fioul_litre   Float?
  conso_gaz_kwh      Float?
  prix_gaz_kwh       Float?
  conso_gpl_kg       Float?
  prix_gpl_kg        Float?
  conso_pellets_kg   Float?
  prix_pellets_kg    Float?
  conso_bois_steres  Float?
  prix_bois_stere    Float?
  conso_elec_kwh     Float?
  prix_elec_kwh      Float?
  cop_actuel         Float?
  conso_pac_kwh      Float?

  // Fixed costs and subscriptions (Novembre 2024)
  // Current electrical power subscription (in kVA: 3, 6, 9, 12, 15, 18)
  puissance_souscrite_actuelle Int @default(6)

  // Annual gas subscription (€/year) - only for type_chauffage = "Gaz"
  abonnement_gaz Float @default(120)

  // Annual maintenance cost of current system (€/year)
  // Average values: Gas 120€, Oil 150€, LPG 130€, Pellets 100€, Wood 80€, Electric 0€
  entretien_annuel Float @default(120)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 3: Projet PAC (Heat Pump Project)
model ProjectProjetPac {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  type_pac           String
  puissance_pac_kw   Float
  cop_estime         Float
  temperature_depart Int? // Optional: only for water-based PACs (Air/Eau, Eau/Eau)
  emetteurs          String? // Optional: only for water-based PACs (Air/Eau, Eau/Eau)
  duree_vie_pac      Int     @default(17) // Estimated heat pump lifespan in years

  // Fixed costs and subscriptions (Novembre 2024)
  // Electricity price (€/kWh) - REQUIRED (moved from current heating)
  // Necessary to calculate heat pump operating cost
  prix_elec_kwh Float @default(0.2516) // Average regulated tariff Base 2024

  // Current electrical power subscription (in kVA: 3, 6, 9, 12, 15, 18)
  // Moved from current heating as needed to recommend power with PAC
  puissance_souscrite_actuelle Int @default(6)

  // Recommended electrical power subscription for PAC (in kVA: 6, 9, 12, 15, 18)
  // Automatically calculated based on puissance_pac_kw, but user-modifiable
  puissance_souscrite_pac Int @default(9)

  // Annual heat pump maintenance cost (€/year)
  // Average value: 120€/year (mandatory annual maintenance)
  entretien_pac_annuel Float @default(120)

  // Electricity price for PAC (€/kWh) - can be different from current price
  // Optional: for off-peak rates or other specific contracts
  prix_elec_pac Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 4: Coûts (Costs)
model ProjectCouts {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  cout_pac             Float
  cout_installation    Float
  cout_travaux_annexes Float
  cout_total           Float

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 5: Aides (Financial Aid)
model ProjectAides {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  ma_prime_renov Float
  cee            Float
  autres_aides   Float
  total_aides    Float // Automatically calculated (sum of aids)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 6: Financement (Financing)
model ProjectFinancement {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  mode_financement  String
  apport_personnel  Float?
  montant_credit    Float?
  taux_interet      Float?
  duree_credit_mois Int?
  mensualite        Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Section 7: Évolutions (Price Evolution)
model ProjectEvolutions {
  id        String  @id @default(cuid())
  projectId String  @unique
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  // Current energy price evolution (based on type_chauffage)
  evolution_prix_fioul Float?
  evolution_prix_gaz   Float?
  evolution_prix_gpl   Float?
  evolution_prix_bois  Float? // For wood and pellets

  // Electricity price evolution for PAC (and also for current electric heating)
  evolution_prix_electricite Float

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
